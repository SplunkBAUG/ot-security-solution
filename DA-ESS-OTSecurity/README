**************************************************************
* Installation Instructions                                  *
**************************************************************

The DA-ESS-OTSecurity app is designed to be used as domain add on with Enterprise Security.  It contained the following components:
1. OT Data Models for OT Hardware and OT Software Assets
2. NERC CIP Dashboards and Reports

The following instructions explain how to install the app.
	1. Follow instructions for installed Splunk Enterprise Security found here:  https://docs.splunk.com/Documentation/ES/6.2.0/Install/InstallEnterpriseSecurity
	2. Install DA-ESS-OTSec App via the Splunk GUI
	3. To show or hide components
		a. Go the Enterprise Security app
		b. Open the Navigation Menu editor (Configure -> General -> Navigation)
		c. Click the Add a New Collection button
		d. On the new menu, click Add Existing
		e. Under Select an App choose DA-ESS-OTSecurity
		f. Choose the OT Security navigation security
		g. Position the menu where desired for navigation.
		h. NERC CIP dashboards and reports can be found under Compliance and can be removed if not needed
	4. Update Lookup Definitions and move them to the EnterpriseSecurity app context
		a. cip_asset_lookup
		b. cip_identities
	5. Update the following macros to point to the Splunk relevant sources, sourcetypes, and/or indexes
		a. get_2fa_indexes: should point to data sources relevant to multi-factor authentication (e.g. OKTA, RSA, etc logs.)
		b. get_app_datamodel:
		c. get_firewall_datasources: should point to firewall configuration data sources (e.g. enabled and disabled port, system configuration files, etc.)
		d. get_installedapps_datasources: should point to the data source which includes all the installed applications about hosts
		e. get_os_datasources: should point to the data source which contains OS information about hosts
		f. get_usb_datasources: should point to the data source that logs external media devices being connected to a host (e.g. endpoint monitoring, windows registry, etc.)
	6. Setup Asset and Identity Management to point to the new lookup files
		a. Go the Enterprise Security App
		b. Go to Asset and Indentity Configuration (Configure -> Data Enchrichment -> Asset and Identity Management)
		c. Go the the Asset Settings Tab
			i. Add the following fields to the configuration
				asset_id (Tag = Yes, Multivalue = No)
				asset_model (Tag = Yes, Multivalue = No)
				asset_status (Tag = Yes, Multivalue = No)
				asset_system (Tag = Yes, Multivalue = No)
				asset_type (Tag = Yes, Multivalue = No)
				asset_vendor (Tag = Yes, Multivalue = No)
				asset_version (Tag = Yes, Multivalue = No)
				classification (Tag = Yes, Multivalue = Yes)
				description (Tag = No, Multivalue = No)
				exposure (Tag = Yes, Multivalue = No)
				location (Tag = No, Multivalue = Yes)
				site_id (Tag = Yes, Multivalue = No)
				zone (Tag = Yes, Multivalue = Yes)
			   See descriptions of these fields here: <link>
		d. Go to the Asset Lookup Configuration Tab
			a. Add New asset lookup configuration
				i. Source: cip_asset_lookup
				ii. Name: <your choice>
				iii. Category: CIP
				iv. Description: List of CIP related assets and characteristics necessary for CIP reporting
				v. Type:  Asset
				vi. Field Exclusion List:  none
		e. Go the Identity Lookup Configuration
			a. Add New identity lookup configuration
				i. Source: cip_identities
				ii. Name: <your choice>
				iii. Category: CIP
				iv: Description:  List of CIP related identities and characters necessary for CIP reporting
				v. Field Exclusion List:  none


	
		
